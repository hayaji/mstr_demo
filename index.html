<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>MicroStrategy Embedded Dossier</title>
    <script
      type="text/javascript"
      src="https://report.diasteknoloji.com/MicroStrategyLibrary/javascript/embeddinglib.js"
    ></script>

    <script>
      // ?§ª Test iÃ§in kullanÄ±lan Ã¶rnek Identity Token (gerÃ§ek kullanÄ±mda backend'den alÄ±nmalÄ±!)
      window.identityToken = "eyJhbGciOiJIUzUxMiIsInppcCI6IkRFRiJ9.eNo00k1zojAAgOH_wrnMkECSsjN7iAQQFEG-Crk4YERQQCpVwM7-9-0e9vpc3_dbGr-kX1JjDs-0eJ-UqAXWug6SKl4F-MT7Dt_8h6cNGxJesEisMiCjSKeTZyf-VoF3_dXN-qGtBr3Bw2vXj3FU46CHc-yOpny2x30kKBDc4mWXo0V5IIbP2R02Pm7vzTTG457FzergZOdzBsfVSoCEy2oQThEqr4pHQdL2G0r0SzJyu8q0Q7SDntM2D5C53lcqGKL7M_Xa_BXTql7icsuYt2NDI5Lz1YV0qGIbIt7ofiFfiWw485VyOhl5Zi-PJjyNGY9x7-07ZUKK9uBq_1KVyMdbVN9UN3Uo6J_HGqw_G98xS_fU3sGzqpnb8y6-mXo5y2I05p4TII6JGXani89CrQmfQQXSrsWb1Qeg3PjYiTi8akpmzCzefmIgt5XG8j3Xmekb5FYXbbR7n0KxOXYHG2bLMX3mcoTUzhqW2vksyDFfe8Ei0A3v9EhV1wrViW-qDinIZdauMA9QGmDntf7aQNHGfF3UhX8YXu7wtG0NPQSNAnn52P-W3qSm-IkOiIZUCHQFvUmnefgPEP6D8VH-bGEwhf2YqqmqYhFkMmZQnb0Ta0UsiC1F-vMXAAD__w.ZK6HRqnuWjyzDj-DNwszjrM44NbNHLGkTwjrTI3mt23b_CembH7ook9eHv9RH5lUAK0nHbNmJkhVNB6jD3ATWQ"; // ?rnek token buraya gelecek
    </script>
  </head>
  <body>
    <div>Embed alanÄ±:</div>
    <div id="mydossier" style="border: 1px solid #ccc; margin-top: 10px;"></div>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function () {
        if (!window.identityToken) {
          alert("??Identity token bulunamadÄ±!");
          return;
        }

        console.log("?“¦ Sayfa yÃ¼klendi, Identity Token ile embed ba?lÄ±yor...");

        const container = document.getElementById("mydossier");
        const dossierUrl =
          "https://report.diasteknoloji.com/MicroStrategyLibrary/app/B1AE84B54741CE143087C3B900E29D47/FD3757D7439EC2DC7E1A3692AC22CF89";

        microstrategy.dossier
          .create({
            url: dossierUrl,
            placeholder: container,
            containerHeight: "1000px",
            enableResponsive: true,
            enableCustomAuthentication: true,
            customAuthenticationType:
              microstrategy.dossier.CustomAuthenticationType.IDENTITY_TOKEN, // ?? Burada de?i?iklik yapÄ±ldÄ±!
            getLoginToken: () => {
              console.log("?? Identity Token gÃ¶nderiliyor:", window.identityToken);
              return Promise.resolve(window.identityToken);
            },
          })
          .then((dossier) => {
            console.log("??Embed i?lemi ba?arÄ±lÄ±:", dossier);
          })
          .catch((err) => {
            console.error("??Embed sÄ±rasÄ±nda hata:", err);
          });
      });
    </script>
  </body>
</html>
